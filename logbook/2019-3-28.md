# creating view to handle followers/floowing/request optemizing docker build for api and adding new pipline for deploy from master

To day I have created a new view to let users manage their followers etc when starting to build this view I realized I needed a new endpoint/endpoints to managed this. I whent with just creating one endpoint couse it seamed a bit unpractiacal with one for each type (folloers/following/request) when I'm going to use them all in the same view (diffrent tabs tought). I created the endpoint and also fixed a bug where requests where not removed from the requests array on a user after request confirmation.

I reused the listableUser component for the followers but hade to make some part of it optional for it to work with the design of the requests "usercard" design. I also rewrote the action for sending a request and created a main  method attemptCreateUserEvent that can be reused for all the diffrent user events I the used som functional programing patterns to partialy apply the function with diffrent arguments for the attemptToggleFollows function and for two new function for confirming and rejecting requests.
I also realisied that the logic for toggleing the spinner when pressing the followbutton was not working correctly, if you pressed one button it shows the spinner for a short while as ecpected but if you press the follow button on a nother user int he same view (this could hapen if you search for users and want to follow several of the users you got back in the search reslut) the preiviuslt pressed button would spin as well, I fix this by passing the id of the targetUserId with the startCreatingUserEvent action so that I then would be able to map that key from the EventState to the followButton and only show the spinner if the id of targetUser of the specific button is the same as the targetUser of the event. I also checked so that this view seamd to llok good on most screensizes.

I then did some inprovments to the production build of the api (previusly the docker containers was indentical in dev and prod) to optimize the preformans and I also created a new pipline for the master bransh and did som set up on my server (digitalocean droplet) to make it work properly (cloning the repos, setting the env variables etc). It turned out however that the images and containers for stage (dev) and prod was overwriting each other, the remedy was to build and start the containers with a project name flag to distinguish the diffrent images and containers from eachoder (the containers actualy hade diffrent names but I guess becouse thay where based on the same image docker-compose was taking down the old containers and then rebuilding them with the new name). I also realized that I hade to enable having a settable port for the mongodb to avoid conflict in the diffrent enviroments.
Still having some problems thought my stage-api does not seam to be able to connect to the database now, will have to look in to that mor tomorrow.