#docker

So I spent a few hours trying to fix my docker problems with my api having troubel connecting to my mogodb at times first I tought it might be a problem with the first instance of my mongo db (for production) intercepting the call ment for the stage mongodb and that seams to have hapend atleast a few times (the logs of the production db container shows this) but after specifying the correct port in the connection string that part was fixed, but still the the api could not connect to the database.
The api is set to try to reconnect if connection fails and att first connect it the api does not seam to find the database (probably due to it not being created yeat) but the secondtime (and for all later atempts) I get a Invalid connection string error. I made some changes do the docker-compose file to try to separate the the staging env and the productions env into diffrent docker networks but that made no diffrence at all, finaly I noticed that if I restarted just the api container everyting worked fine wich led me to beleve that some how if the mogodb container has not started the api is not able to create the connection (this eventhought the IP to the database was correct when I was logging it or error to connect), so I tried to chaange the docker-compose again to add a depends_on variable to make sure that the database container will be instageted first. How ever this did not help either, meaby I need some kind of script (like wait-for-it) to ensure that the database has actualy boted up entierly befor starting the api, not that this is only a problem if the changes of the deploy that contains changes that affect the build of the db container becouse thats the only time it will restart and therfor the only time it might not be availible when the api restarts, but still the solution right now does not feel optimal but for now everything is working and I have leard some mor about docker in general.